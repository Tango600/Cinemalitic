ReportOfficeSheet=Template=FilmsDelivery.xlsx;SQL=select FD.delivery_num, c.agreement_date, t.cinema_name, F.film_name, coalesce('с ' || DATE2STR(fc.roll_date_begin) || ' по ', '') || coalesce(DATE2STR(fc.roll_date_end), '') roll_dates, mt.media_name from FILMS_TO_CONTRACTS FC left join FILMS F on FC.FILM_ID = F.ID_FILM left join FILMS_DELIVERYS FD on FC.CONTRACT_ID = FD.CONTRACT_ID and FC.FILM_ID = FD.FILM_ID left join CONTRACTS C on C.contract_id = fd.contract_id left join theaters t on c.cinema_id = t.cinema_id left join media_type mt on c.media_type_id = mt.med_id where fd.film_id is not null and c.agreement_date between GET_QUARTAL_BEG_DATE(&QQuartal, &QYear) and add_months(GET_QUARTAL_BEG_DATE(&QQuartal, &QYear), 3)-1 order by c.agreement_date, fd.delivery_num;OfficeType=mso;FillStrategy=replace;